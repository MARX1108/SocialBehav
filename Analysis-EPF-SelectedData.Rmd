---
title: "Analysis-EPF-SelectedData"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Setup
Enviroment Setup
```{r, warning=FALSE, results='hide'}
odf <- read.csv('./cleandata.csv')
library('caret')
#setwd('~/Desktop/andlab/code')
```
## Additional Analysis W/ Selected Data, Significant Attributes
```{r}
df <- read.csv('cleandata.csv')
odf<- df[(df$aggressive_sumscore  <= (-2.020650971)) | (df$aggressive_sumscore  >= (0.2168869)), ]
odf$y <- ifelse(odf$aggressive_sumscore <= (-2.020650971), 0, 1)
df <- subset(odf, select=c(y, asr_scr_perstr_t, asr_scr_anxdep_t, asr_scr_aggressive_t, asr_scr_rulebreak_t, asr_scr_external_t, asr_scr_totprob_t, kbi_p_conflict, kbi_p_c_bully, kbi_p_c_mh_sa, fes_youth, fes_p_ss_fc_pr, macv_p_ss_r, demo_prnt_age_v2, demo_prnt_marital_v2, demo_comb_income_v2, demo_fam_exp, demo_yrs_2, neighborhood_crime_y, sex))
```

###Logistic Regression
Model Selection
```{r}
glm.fit <- glm(y ~ ., data = df, family = binomial)
```
Result
```{r}
summary(glm.fit)

cm <- confusionMatrix(table(as.numeric(glm.fit$fitted.values>0.5), df$y))
print(cm)
print(cm$byClass)
```

## Analysis W/ Selected Data, Selected Attributes
```{r}
df <- read.csv('cleandata.csv')
odf<- df[(df$aggressive_sumscore  <= (-2.020650971)) | (df$aggressive_sumscore  >= (0.2168869)), ]
odf$y <- ifelse(odf$aggressive_sumscore <= (-2.020650971), 0, 1)
df <- subset(odf, select=-c(X, prosocial_child, prosocial_parent, interview_date, interview_age, subjectkey, asr_scr_perstr_t, asr_scr_somaticpr_t, asr_scr_inattention_t,
 crpbi_bothcare, kbi_p_c_best_friend, kbi_p_c_reg_friend_group, macv_p_ss_fs, macv_p_ss_fo, macv_p_ss_isr,macv_p_ss_fr, macv_p_ss_r, demo_prnt_age_v2, demo_prnt_marital_v2, demo_comb_income_v2, demo_yrs_1, demo_yrs_2, parent_rules_q1, parent_rules_q4, parent_rules_q7, su_risk_p_1, su_risk_p_2_3, su_risk_p_4_5, aggressive_sumscore))
```

###Logistic Regression
Model Selection
```{r}
glm.fit <- glm(y ~ ., data = df, family = binomial)
```
Result
```{r}
summary(glm.fit)

cm <- confusionMatrix(table(as.numeric(glm.fit$fitted.values>0.5), df$y))
print(cm)
print(cm$byClass)
```



###Logistic Regression W/ Interaction
Model Selection
```{r}
glm.fit <- glm(y ~ . + .^2, data = df, family = binomial)
```
Result
```{r}
summary(glm.fit)

cm <- confusionMatrix(table(as.numeric(glm.fit$fitted.values>0.5), df$y))
print(cm)
print(cm$byClass)
```


###Step Wise Logistic Regression StepWise
Model Selection
```{r}
library(MASS)
library(tidyverse)
glm.fit <- glm(y ~ ., data = df, family = binomial)
step.model <- glm.fit %>% stepAIC(trace = FALSE)

```
Result
```{r}
summary(step.model)
cm <- confusionMatrix(table(as.numeric(step.model$fitted.values>0.5), df$y))
print(cm)
print(cm$byClass)
```


###Step Wise Logistic Regression W/ Interaction
Model Selection
```{r}
#glm.fit <- glm(y ~ . + .^2, data = df, family = binomial)
#step.model <- glm.fit %>% stepAIC(trace = FALSE)
```
Result
```{r}
#summary(step.model )

#cm <- confusionMatrix(table(as.numeric(step.model $fitted.values>0.5), df$y))
#print(cm)
#print(cm$byClass)
```


## Analysis W/ Selected Data, All Attributes
```{r}
df <- read.csv('cleandata.csv')
odf<- df[(df$aggressive_sumscore  <= (-2.020650971)) | (df$aggressive_sumscore  >= (0.2168869)), ]
odf$y <- ifelse(odf$aggressive_sumscore <= (-2.020650971), 0, 1)
df <- subset(odf, select=-c(X,aggressive_sumscore , prosocial_child, prosocial_parent, interview_date, interview_age, subjectkey))
```

###Logistic Regression
Model Selection
```{r}
glm.fit <- glm(y ~ ., data = df, family = binomial)
```
Result
```{r}
summary(glm.fit)

cm <- confusionMatrix(table(as.numeric(glm.fit$fitted.values>0.5), df$y))
print(cm)
print(cm$byClass)
```



###Logistic Regression W/ Interaction
Model Selection
```{r}
glm.fit <- glm(y ~ . + .^2, data = df, family = binomial)
```
Result
```{r}
summary(glm.fit)

cm <- confusionMatrix(table(as.numeric(glm.fit$fitted.values>0.5), df$y))
print(cm)
print(cm$byClass)
```


###Step Wise Logistic Regression StepWise
Model Selection
```{r}
library(MASS)
library(tidyverse)
glm.fit <- glm(y ~ ., data = df, family = binomial)
step.model <- glm.fit %>% stepAIC(trace = FALSE)

```
Result
```{r}
summary(step.model)
cm <- confusionMatrix(table(as.numeric(step.model$fitted.values>0.5), df$y))
print(cm)
print(cm$byClass)
```


###Step WiseLogistic Regression W/ Interaction
Model Selection
```{r}
#glm.fit <- glm(y ~ . + .^2, data = df, family = binomial)
#step.model <- glm.fit %>% stepAIC(trace = FALSE)
```
Result
```{r}
#summary(step.model )

#cm <- confusionMatrix(table(as.numeric(step.model $fitted.values>0.5), df$y))
#print(cm)
#print(cm$byClass)
```

